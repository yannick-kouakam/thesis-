function C = CoriolisMatrix(q,qd)
%CORIOLISMATRIX Summary of this function goes here
%   Detailed explanation goes here
%%Coriollis and Centrifugal components
global l1 l2 l3 lc1 lc2 lc3 m1 m2 m3 I1 I2 I3;
q1=q(1); qd1 = qd(1);
q2 =q(2); qd2 = qd(2);
q3 = q(3); qd3=q(3);
c11 = 0 ;c22=0 ;c33=0;
c12 = qd2*(m2*(lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))) - m3*((l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - (l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)))) - qd3*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) - lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) + lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 - (m2*(lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))))/2 + (m3*((l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - (l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2) + qd1*((m2*(lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))))/2 + (m2*(2*lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - 2*lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))))/2 - (m3*((l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - (l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2 - (m3*(2*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - 2*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2);
c13 =- qd2*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) + lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 + (m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2) - qd1*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2 + (m3*(2*lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - 2*lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2) - m3*qd3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))); 

c21 = (m3*qd3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) - lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) + lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 - qd1*((m2*(2*lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - 2*lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))))/2 - (m3*(2*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - 2*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2) - qd2*((m2*(lc2*cos(q1 + q2)*(lc2*sin(q1 + q2) + l1*sin(q1)) - lc2*sin(q1 + q2)*(lc2*cos(q1 + q2) + l1*cos(q1))))/2 - (m3*((l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - (l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3))*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2);
c23 =- qd1*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) + lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 - (m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) - lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) + lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 + (m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2) - qd2*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 + (m3*(2*lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - 2*lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2) - m3*qd3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3)));

c31 =(m3*qd3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2 + (m3*qd1*(2*lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - 2*lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3))))/2 + (m3*qd2*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) + lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2;
c32 = qd1*((m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) + lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 - (m3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + l1*cos(q1) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + l1*sin(q1) + lc3*sin(q1 + q2 + q3)) - lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) + lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2) + (m3*qd3*(lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2 + (m3*qd2*(2*lc3*sin(q1 + q2 + q3)*(l2*cos(q1 + q2) + lc3*cos(q1 + q2 + q3)) - 2*lc3*cos(q1 + q2 + q3)*(l2*sin(q1 + q2) + lc3*sin(q1 + q2 + q3))))/2;

C=[ c11 , c12 , c13;...
    c21 , c22 , c23;...
    c31 , c32 , c33];
end

